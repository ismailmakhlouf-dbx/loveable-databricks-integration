# Databricks Asset Bundle for {{ project_name }}
# Auto-generated by Lovable Bridge MCP Server

bundle:
  name: {{ bundle_name }}

workspace:
  host: {{ workspace_host }}

resources:
  apps:
    {{ app_name }}:
      name: {{ app_name }}
      description: {{ app_description }}

      resources:
        - name: app-instance
          app:
            name: ${var.app_name}
            config_file_path: ./app.yaml

      permissions:
        - level: CAN_USE
          group_name: users

{% if jobs %}
  jobs:
    {% for job in jobs %}
    {{ job.name }}:
      name: {{ job.name }}
      tasks:
        - task_key: {{ job.task_key }}
          notebook_task:
            notebook_path: {{ job.notebook_path }}
          cluster:
            node_type_id: {{ job.node_type }}
            num_workers: {{ job.num_workers }}
    {% endfor %}
{% endif %}

{% if volumes %}
  volumes:
    {% for volume in volumes %}
    {{ volume.name }}:
      name: {{ volume.name }}
      catalog_name: {{ volume.catalog }}
      schema_name: {{ volume.schema }}
      volume_type: {{ volume.type }}
      comment: {{ volume.comment }}
    {% endfor %}
{% endif %}

targets:
  dev:
    mode: development
    workspace:
      host: {{ dev_workspace_host }}
    variables:
      app_name: {{ app_name }}-dev
      catalog: {{ dev_catalog }}
      schema: {{ dev_schema }}

  prod:
    mode: production
    workspace:
      host: {{ prod_workspace_host }}
      root_path: /Workspace/.bundle/${bundle.name}/prod
    variables:
      app_name: {{ app_name }}
      catalog: {{ prod_catalog }}
      schema: {{ prod_schema }}
    run_as:
      service_principal_name: {{ service_principal }}
